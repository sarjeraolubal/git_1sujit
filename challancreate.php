<html>  <head>    <title>       Displaying PAYROLL Register   </title>  </head>  <body>    <h1>Displaying PAYROLL Register  </h1>    <?php	//require "dist/lib/commonfunc.php";//validatepage();require "dist/lib/dbconnection.php";require "dist/lib/lib_dailychallan_c.php";//require "dist/lib/dataextrfunc.php";				   //  function mysql_escape_string($string){return mysqli_escape_string($string);}	         $_SESSION["FORMTRANMODE"] = null;          	     GLOBAL $selecteddata_list;         GLOBAL $List_Pay_MASTER ;		$selecteddata_list = search_datalist1();				$List_Pay_MASTER  = List_Pay_M($selecteddata_list);		if ($List_Pay_MASTER == "SUCCESS"){ echo  $record_count . "  records inserted "; }                                      ELSE	{ echo  " NONE records inserted "; }								        // mysqli_close($connection);    ?>   <p><a href=#>GO BACK MAIN MENU</a></p>  </body></html>    <?php          function search_datalist1(){          $extr_datalist1 = array();            $pdo = DBconnectionUtil::connect();           $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);         try{              $sql = "			  SELECT  challan.CO_CODE,                      challan.SLIPNO,                      challan.VSLCD,                      challan.dwd_date,                      challan.SHED,                      challan.SHIFT,                      challan.gangcode1,                      challan.BADGENO1,                      challan.gangcode2,                      challan.BADGENO2,                      challan.gangcode3,                      challan.BADGENO3,                      challan.gangcode4,                      challan.BADGENO4,                      challan.gangcode5,                      challan.BADGENO5,                      challan.gangcode6,                      challan.BADGENO6,                      challan.gangcode7,                      challan.BADGENO7,                      challan.gangcode8,                      challan.BADGENO8,                      challan.gangcode9,                      challan.BADGENO9,                      challan.gangcode10,                      challan.BADGENO10,                      challan.gangcode11,                      challan.BADGENO11,                      challan.gangcode12,                      challan.BADGENO12,                      challan.gangcode13,                      challan.BADGENO13,                      challan.WORKTYPE1,                      challan.WORKRATE1,                      challan.WORK_QTY1,                      challan.WORKTYPE2,                      challan.WORKRATE2,                      challan.WORK_QTY2,                      challan.WORKTYPE3,                      challan.WORKRATE3,                      challan.WORK_QTY3,                      challan.WORKTYPE4,                      challan.WORKRATE4,                      challan.WORK_QTY4,                      challan.LAB_RTCD,                      challan.LAB_NO,                      challan.LAB_RATE,                      challan.QUANTITY,                      challan.RATE,                      challan.AMOUNT,                      challan.NO_MEN,                      challan.MATHA,                      challan.COMODITY                 FROM challan						                 ";                $q = $pdo->prepare($sql);                $q->execute();        $extr_datalist1 = $q->fetchAll();         }         catch (PDOException $sql_err) {	      $errmsg = "TechError: search data list:".$sql_err->getMessage().", contact system administrator";	        error_log($errmsg,0);                              }DBconnectionUtil::disconnect();return $extr_datalist1;     }	 	 	 //-- List of  db table	                   function List_Pay_M(){                       $pdo = DBconnectionUtil::connect();                        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);                       GLOBAL $errmsg;                //-- For Gang Code							    GLOBAL $selecteddata_list;				global $record_count;                $record_count   = count($selecteddata_list);							     //-- For Primay Info	GLOBAL $dwd_tabreckey;	GLOBAL $sys_co_code;	GLOBAL $dwd_date;	GLOBAL $dwd_slip_nbr;	GLOBAL $vm_code;	GLOBAL $dwd_cha_no;	GLOBAL $dwd_shed;	GLOBAL $dwd_shift;	GLOBAL $cm_code;	GLOBAL $clrm_code;	GLOBAL $dwd_labors;	GLOBAL $dwd_lab_amount;	GLOBAL $wtm_amount;    GLOBAL $dwd_total_amount;	GLOBAL $dwd_totalperson;	GLOBAL $dwd_matha;    GLOBAL $gm_gang_code;               															  // Add modified/new row into list to display	          // Work Details	           GLOBAL $workdetails_list;	           $workdetails_list  = array();  	                GLOBAL $wtm_code;				GLOBAL $wtm_rate;				GLOBAL $dwd_bags;				GLOBAL $wtm_amount;																					GLOBAL $gangdetails_list;				$gangdetails_list  = array();				GLOBAL $gm_gang_code;				GLOBAL $gm_badge_no;				GLOBAL $gm_memcatg;				GLOBAL $gm_bankaccnbr;				GLOBAL $gm_name;		     																																	         foreach ($selecteddata_list as $row)       {		      		  		  		$sys_co_code 			  		  =  $row['CO_CODE'] ;		  		$dwd_slip_nbr  			  		  =  $row['SLIPNO'] ;				echo " SLIP NO : " . $dwd_slip_nbr . " is processing";						  		$vm_code  		  				  =  $row['VSLCD'] ;		  		$dwd_date 		  	   			  =  $row['dwd_date'] ;		  		$dwd_shed  		  				  =  $row['SHED'] ;		  		$dwd_shift                        =  $row['SHIFT'] ;	            IF  (!empty($row['gangcode1'])) {		  		$gm_gang_code[0]  		  		  =  $row['gangcode1'] ;		  		$gm_badge_no[0]   		  		  =  $row['BADGENO1'] ;}				IF  (!empty($row['gangcode2'])) {		  		$gm_gang_code[1]  		  		  =  $row['gangcode2'] ;		  		$gm_badge_no[1]  		  		  =  $row['BADGENO2'] ;}				IF  (!empty($row['gangcode3'])) {                $gm_gang_code[2]  		  		  =  $row['gangcode3'] ; 		  		$gm_badge_no[2]  		  		  =  $row['BADGENO3'] ;}	            IF  (!empty($row['gangcode4'])) {             	$gm_gang_code[3]  		  		  =  $row['gangcode4'] ; 		  		$gm_badge_no[3]  		  		  =  $row['BADGENO4'] ;}	            IF  (!empty($row['gangcode5'])) {	            $gm_gang_code[4]  		  		  =  $row['gangcode5'] ; 		  		$gm_badge_no[4]  		  		  =  $row['BADGENO5'] ;}	            IF  (!empty($row['gangcode6'])) {	            $gm_gang_code[5]  		  		  =  $row['gangcode6'] ;   		  		$gm_badge_no[5]  		  		  =  $row['BADGENO6'] ;}	            IF  (!empty($row['gangcode7'])) {				$gm_gang_code[6]  		  		  =  $row['gangcode7'] ;		  		$gm_badge_no[6]  		  		  =  $row['BADGENO7'] ;}	            IF  (!empty($row['gangcode8'])) {		  		$gm_gang_code[7]  		  		  =  $row['gangcode8'] ;		  		$gm_badge_no[7]  		  		  =  $row['BADGENO8'] ;}	            IF  (!empty($row['gangcode9'])) {		  		$gm_gang_code[8]  		  		  =  $row['gangcode9'] ;		  		$gm_badge_no[8]  		  		  =  $row['BADGENO9'] ; }	            IF  (!empty($row['gangcode10'])) {		  		$gm_gang_code[9]  		  		  =  $row['gangcode10'] ;		  		$gm_badge_no[9]  		  		  =  $row['BADGENO10'] ;}	            IF  (!empty($row['gangcode11'])) {		  		$gm_gang_code[10]  		  		  =  $row['gangcode11'] ;		  		$gm_badge_no[10]  		  		  =  $row['BADGENO11'] ;}	            IF  (!empty($row['gangcode12'])) {		  		$gm_gang_code[11]  		  		  =  $row['gangcode12'] ;		  		$gm_badge_no[11]  		  		  =  $row['BADGENO12'] ;}	            IF  (!empty($row['gangcode13'])) {		  		$gm_gang_code[12]  		  		  =  $row['gangcode13'] ;		  		$gm_badge_no[12]  		  		  =  $row['BADGENO13'] ;}												// $wtm_code[0] = $wtm_code[1]  = $wtm_code[2] = $wtm_code[3] = null;								IF  (!empty($row['WORKTYPE1'])) {		  		$wtm_code[0]  		  		  =  $row['WORKTYPE1'] ;		  		$wtm_amount[0]  		  	  =  $row['WORKRATE1']  / 100  ;		  		$dwd_bags[0]  		  		  =  $row['WORK_QTY1']  / 1000 ;				$wtm_amount[0]  		  	  =  ($wtm_amount[0]  * $dwd_bags[0]) / 100;}				IF  (!empty($row['WORKTYPE2'])) {		  		$wtm_code[1]  		  		  =  $row['WORKTYPE2'] ;		   		$wtm_amount[1]  		  	  =  $row['WORKRATE2']  / 100  ;				$dwd_bags[1]    		  	  =  $row['WORK_QTY2']  / 1000 ;				$wtm_amount[1]  		  	  =  ($wtm_amount[1]  * $dwd_bags[1]) / 100  ;}				IF  (!empty($row['WORKTYPE3'])) {			  		$wtm_code[2]  		  		  =  $row['WORKTYPE3'] ;		  		$wtm_amount[2]  		  	  =  $row['WORKRATE3']  / 100  ;		  		$dwd_bags[2]    		  	  =  $row['WORK_QTY3']  / 1000 ;				$wtm_amount[2]  		  	  =  $wtm_amount[2]  * $dwd_bags[2] / 100 ;}								IF  (!empty($row['WORKTYPE4'])) {		  		$wtm_code[3]  		  		  =  $row['WORKTYPE4'] ;		  		$wtm_amount[3]  		  	  =  $row['WORKRATE4']  / 100  ;    	  		$dwd_bags[3]    		  	  =  $row['WORK_QTY4']  / 1000 ;				$wtm_amount[3]  		  	  =  $wtm_amount[3]  * $dwd_bags[3] / 100;}			  		$clrm_code  		  		  =  $row['LAB_RTCD'] ;		  		$dwd_labors  		  		  =  $row['LAB_NO'] ;		  		$dwd_lab_amount 	  		  =  $row['LAB_RATE']   / 100;		  	//	$  		  		  =  $row['QUANTITY'] ;		  	//	$  		  		  =  $row['RATE'] ;		  		$dwd_total_amount    		  =  $row['AMOUNT']  / 100;		  		$dwd_totalperson  	  		  =  $row['NO_MEN']  ;		  		$dwd_matha  		  		  =  $row['MATHA'] / 100;		  		$cm_code  		  	    	  =  $row['COMODITY'] ;		  		  dailychallan_insupddb();		  		      $wtm_code=array();              $gm_badge_no=array();              $gm_gang_code=array();		            }      		 		 	DBconnectionUtil::disconnect();return "SUCCESS";}?>