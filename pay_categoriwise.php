<html>  <head>    <title>       Displaying TEMPA Register   </title>   <style>   .textright{	   text-align:right;   }   </style>  </head>  <body>    <h1>Displaying TEMPORARY Register  </h1>    <?php	//require "dist/lib/commonfunc.php";//validatepage();require "dist/lib/dbconnection.php";//require "dist/lib/dataextrfunc.php";				   //  function mysql_escape_string($string){return mysqli_escape_string($string);}	          	     GLOBAL $selecteddata_list;         GLOBAL $List_Pay_MASTER ;		$selecteddata_list = search_datalist();				$List_Pay_MASTER  = List_Pay_M($selecteddata_list);		if ($List_Pay_MASTER == "SUCCESS"){ echo  $record_count . "  records inserted "; }                                      ELSE	{ echo  " NONE records inserted "; }								        // mysqli_close($connection);    ?>   <p><a href=#>GO BACK MAIN MENU</a></p>  </body></html>    <?php          function search_datalist(){          $extr_datalist = array();            $pdo = DBconnectionUtil::connect();           $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);         try{              $sql = "Select gm_tabreckeyPrimary,			                 lp_pay_m.sys_co_code,                             lp_pay_m.py_year_mm,                             lp_pay_m.py_badge_no,                              lp_pay_m.py_gang_code,                              lp_gang_m.gm_name,                              lp_pay_m.basic,							 lp_pay_m.da,                              lp_pay_m.hra, 							 lp_pay_m.pf,                              lp_pay_m.ptax, 							 lp_pay_m.advance,                              lp_pay_m.esic_e, 							 lp_pay_m.net_salary,                             lp_pay_m.category as category,                              lp_pay_m.account_number,                              lp_pay_m.esic_o,                              lp_pay_m.no_of_days                  From        lp_gang_m                  Inner Join  lp_pay_m On lp_pay_m.py_badge_no = lp_gang_m.gm_badge_no 			                    Order By  lp_pay_m.sys_co_code, 				             lp_pay_m.py_year_mm,							 lp_pay_m.category, 				             lp_pay_m.py_badge_no							";                $q = $pdo->prepare($sql);                $q->execute();        $extr_datalist = $q->fetchAll();								         }         catch (PDOException $sql_err) {	      $errmsg = "TechError: search data list:".$sql_err->getMessage().", contact system administrator";	        error_log($errmsg,0);                              }DBconnectionUtil::disconnect();return $extr_datalist;     }	 	 	 //-- List of  db table	                   function List_Pay_M(){                       $pdo = DBconnectionUtil::connect();                        $pdo->setAttribute(PDO::ATTR_ERRMODE, PDO::ERRMODE_EXCEPTION);                       GLOBAL $errmsg;                //-- For Gang Code							    GLOBAL $selecteddata_list;												                				global $record_count;                $record_count   = count($selecteddata_list);					//			foreach ($selecteddata_list as $row) {																																		 $category_w = 	$selecteddata_list[0][14];																					      echo "<table border='1'>";      echo "<tr>";      echo "<th>Sr.no</th> <th>Co-cd</th> <th>YYYYY<br/> MM </th> <th> Account Number</th><th> Badge <br/>No</th> <th> Name </th>  <th>GANG</th> <th>category </th> <th>basic</th> <th>DA </th> <th>basic + da</th>   <th>HRA </th>   <th>Gross</th>  <th>PF</th> <th>PTAX </th> <th>ESIC-<br/>EMP</th> <th>Salary </th> <th>Advance</th>  <th>Net Pay</th> <th>ESIC-<br/>Office </th>";	       $sumbasic      = 0;	       $sumda         = 0;		   $sumpay_da     = 0;           $sumgross      = 0;			           $sumhra        = 0;				       $sumpf         = 0;           $sumptax       = 0;			           $sumadvance    = 0;						   $sumesic_e     = 0;           $sumsalary     = 0;			           $sumnet_salary = 0;				       $sumesic_o     = 0;      // initialise counters   		   $sum_cat_basic      = 0;	       $sum_cat_da         = 0;		   $sum_cat_pay_da     = 0;           $sum_cat_gross      = 0;			           $sum_cat_hra        = 0;				       $sum_cat_pf         = 0;           $sum_cat_ptax       = 0;			           $sum_cat_advance    = 0;						   $sum_cat_esic_e     = 0;           $sum_cat_salary     = 0;			           $sum_cat_net_salary = 0;				       $sum_cat_esic_o     = 0;						         foreach ($selecteddata_list as $row)       {                          $py_badge_no   =      $row['py_badge_no'] ;			    $py_gang_code   =     $row['py_gang_code'];                $gm_name   =          $row['gm_name'] ;                $basic   =            $row['basic'];                $da   =               $row['da'];			    $pay_da  =            $basic + $da;                $hra   =              $row['hra'];  	            $gross =              $pay_da + $hra;                $pf   =               $row['pf'];                 $ptax   =             $row['ptax'];                 $advance   =          $row['advance'];                $esic_e   =           $row['esic_e'];                $salary     =         $gross - $pf - $esic_e;                $net_salary   =       $row['net_salary'];                $category   =         $row['category'];                $account_number =     $row['account_number'];                $esic_o   =           $row['esic_o'];                             // sums  for total                                    $sumbasic      +=          $basic;				$sumda 		   +=          $da;				$sumpay_da     +=          $pay_da;				$sumhra        +=          $hra;				$sumgross      +=          $gross;				$sumpf         +=          $pf  ;				$sumptax       +=          $ptax  ;				$sumadvance    +=          $advance  ;				$sumesic_e     +=          $esic_e  ;				$sumsalary     +=          $salary  ;				$sumnet_salary +=          $net_salary  ;				$sumesic_o     +=          $esic_o ;		 // sums  for category   		     IF ($category_w        ==          $category)			    {				$sum_cat_basic      +=          $basic;                $sum_cat_da 	    +=          $da;				$sum_cat_pay_da     +=          $pay_da;				$sum_cat_hra        +=          $hra;				$sum_cat_gross      +=          $gross;				$sum_cat_pf         +=          $pf  ;				$sum_cat_ptax       +=          $ptax  ;				$sum_cat_advance    +=          $advance  ;				$sum_cat_esic_e     +=          $esic_e  ;				$sum_cat_salary     +=          $salary  ;				$sum_cat_net_salary +=          $net_salary  ;				$sum_cat_esic_o     +=          $esic_o ;			    }            ELSE			    {											  	    echo "<tr>";        echo "<td>", "        ", "</td><td>", "                   ", "</td><td>", "         ", "</td>   <td>","      ", "</td>  <td>", "        ","</td><td>", 		"    ", "</td><td>", "          ", "</td><td>", $category_w, "</td><td class='textright'>",		$sum_cat_basic, "</td><td class='textright'>", $sum_cat_da, "</td><td class='textright' >", $sum_cat_pay_da, "</td><td class='textright'  >", 		$sum_cat_hra, "</td><td class='textright'  >", $sum_cat_gross, "</td><td class='textright'  >", $sum_cat_pf, "</td><td class='textright'  >", $sum_cat_ptax, "</td><td class='textright' >", 		$sum_cat_esic_e,"</td><td class='textright' >", $sum_cat_salary, "</td><td class='textright'  >", $sum_cat_advance, "</td><td class='textright' >", $sum_cat_net_salary,"</td><td class='textright' >", $sum_cat_esic_o;            echo "</tr>";	  //   now add to counters					$category_w         =          $category;				$sum_cat_basic      =          $basic;                $sum_cat_da 	    =          $da;				$sum_cat_pay_da     =          $pay_da;				$sum_cat_hra        =          $hra;				$sum_cat_gross      =          $gross;				$sum_cat_pf         =          $pf  ;				$sum_cat_ptax       =          $ptax  ;				$sum_cat_advance    =          $advance  ;				$sum_cat_esic_e     =          $esic_e  ;				$sum_cat_salary     =          $salary  ;				$sum_cat_net_salary =          $net_salary  ;				$sum_cat_esic_o     =          $esic_o ;				 				}	 				 				 				 				                                       echo "<tr>";        echo "<td>", $row['gm_tabreckeyPrimary'], "</td><td>", $row['sys_co_code'], "</td><td>", $row['py_year_mm'], "</td>   <td>", $account_number, "</td>  <td class='textright'>", $py_badge_no,"</td><td>", 		$gm_name, "</td><td>", $py_gang_code, "</td><td>", $category, "</td><td class='textright'>",     	$basic, "</td><td class='textright'>", $da, "</td><td class='textright'>", $pay_da, "</td><td class='textright'>", 		$hra, "</td><td class='textright'>", $gross, "</td><td class='textright'>", $pf, "</td><td class='textright'>", $ptax, "</td><td class='textright'>", 		$esic_e,"</td><td class='textright'>", $salary, "</td><td class='textright'>", $advance, "</td><td class='textright'>", $net_salary,"</td><td class='textright'>", $esic_o;            echo "</tr>";      }	  	  	  	  	  	   echo "<tr>";        echo "<td>", "        ", "</td><td>", "                   ", "</td><td>", "         ", "</td>   <td>","      ", "</td>  <td>", "        ","</td><td>", 		"    ", "</td><td>", "          ", "</td><td>", "         ", "</td><td>",     	$sumbasic, "</td><td class='textright'>", $sumda, "</td><td class='textright' >", $sumpay_da, "</td><td class='textright'  >", 		$sumhra, "</td><td class='textright'  >", $sumgross, "</td><td class='textright'  >", $sumpf, "</td><td class='textright'  >", $sumptax, "</td><td class='textright' >", 		$sumesic_e,"</td><td class='textright' >", $sumsalary, "</td><td class='textright'  >", $sumadvance, "</td><td class='textright' >", $sumnet_salary,"</td><td class='textright' >", $sumesic_o;            echo "</tr>";	               		 		 	DBconnectionUtil::disconnect();return "SUCCESS";}?>